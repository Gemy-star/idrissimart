{% extends "base.html" %}

{% load static i18n %}

{% block title %}
    {% trans "الرئيسية" %} - {% trans "إدريسي مارت" %}

{% endblock title %}

{% block content %}
    <!-- Hero Section -->
    <section class="hero-section" id="home">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6 hero-content">
                    <h1 class="hero-title">{% trans "منصة تجمع سوق واحد متكامل" %}</h1>
                    <p class="hero-subtitle">
                        {% trans "منصة تجمع سوق واحد متخصص يستفيد منه المتخصصون والجمهور العام الذي يحتاج إلى أيٍ من خدمات هذا السوق" %}
                    </p>
                    <a href="{% url 'main:categories' %}"
                       class="btn btn-custom btn-secondary-custom btn-hero me-3">
                        <i class="fas fa-store me-2"></i>{% trans "استكشف أقسام المنصة" %}
                    </a>
                    <a href="{% url 'main:contact' %}"
                       class="btn btn-custom btn-secondary-custom btn-hero me-3">
                        <i class="fas fa-handshake me-2"></i>{% trans "تواصل مع فريقنا" %}
                    </a>
                </div>
                <div class="col-lg-6 mt-5 mt-lg-0">
                    <img src="https://images.unsplash.com/photo-1545239351-1141bd82e8a6?w=600&h=500&fit=crop"
                         alt="Unified marketplace"
                         width="600"
                         height="500"
                         class="img-fluid rounded-4 shadow-lg"
                         id="heroImage" />
                </div>
            </div>
        </div>
    </section>
    <!-- Categories Section -->
    <section class="categories-section" id="categories">
        <div class="container">
            <h2 class="section-title">{% trans "أقسام السوق الموحد" %}</h2>
            <!-- Quick section tabs -->
            <div class="categories-tabs mb-3">
                <div class="tab-buttons">
                    <button class="tab-btn active" data-tab="all">
                        <i class="fas fa-th-large"></i>
                        {% trans "جميع الفئات" %}
                    </button>
                    {% for section_code, section_data in categories_by_section.items %}
                        <button class="tab-btn" data-tab="{{ section_code }}">
                            {% if section_code == 'classified' %}
                                <i class="fas fa-bullhorn"></i>
                            {% elif section_code == 'product' %}
                                <i class="fas fa-shopping-basket"></i>
                            {% elif section_code == 'service' %}
                                <i class="fas fa-concierge-bell"></i>
                            {% elif section_code == 'course' %}
                                <i class="fas fa-chalkboard-teacher"></i>
                            {% elif section_code == 'job' %}
                                <i class="fas fa-briefcase"></i>
                            {% else %}
                                <i class="fas fa-folder"></i>
                            {% endif %}
                            {{ section_data.name }}
                        </button>
                    {% endfor %}
                </div>
            </div>
            <!-- All Categories Tab (Default) -->
            <div class="tab-content active" id="all">
                {% for section_code, section_data in categories_by_section.items %}
                    {% if section_data.categories %}
                        <div class="section-group mb-5">
                            <h3 class="section-subtitle">{{ section_data.name }}</h3>
                            <div class="row g-4">
                                {% for cat_data in section_data.categories %}
                                    <div class="col-lg-4 col-md-6">
                                        <div class="category-card">
                                            <div class="category-icon">
                                                {% if cat_data.category.icon %}
                                                    <i class="{{ cat_data.category.icon }}"></i>
                                                {% else %}
                                                    <i class="fas fa-folder"></i>
                                                {% endif %}
                                            </div>
                                            <h4 class="category-title">
                                                {% if LANGUAGE_CODE == 'ar' and cat_data.category.name_ar %}
                                                    {{ cat_data.category.name_ar }}
                                                {% else %}
                                                    {{ cat_data.category.name }}
                                                {% endif %}
                                            </h4>
                                            <p class="category-desc">{{ cat_data.category.description|truncatewords:15 }}</p>
                                            {% if cat_data.subcategories %}
                                                <div class="subcategories-list mb-3">
                                                    <h6 class="subcategories-title">{% trans "التصنيفات الفرعية:" %}</h6>
                                                    <ul class="subcategories">
                                                        {% for subcat in cat_data.subcategories %}
                                                            <li>
                                                                {% if subcat.slug %}
                                                                    <a href="{% url 'main:category_detail' subcat.slug %}"
                                                                       class="subcategory-link">
                                                                        {% if LANGUAGE_CODE == 'ar' and subcat.name_ar %}
                                                                            {{ subcat.name_ar }}
                                                                        {% else %}
                                                                            {{ subcat.name }}
                                                                        {% endif %}
                                                                    </a>
                                                                {% else %}
                                                                    <span class="subcategory-link disabled">
                                                                        {% if LANGUAGE_CODE == 'ar' and subcat.name_ar %}
                                                                            {{ subcat.name_ar }}
                                                                        {% else %}
                                                                            {{ subcat.name }}
                                                                        {% endif %}
                                                                    </span>
                                                                {% endif %}
                                                            </li>
                                                        {% endfor %}
                                                    </ul>
                                                </div>
                                            {% endif %}
                                            {% if cat_data.category.slug %}
                                                <a href="{% url 'main:category_detail' cat_data.category.slug %}"
                                                   class="btn btn-custom btn-primary-custom mt-3">
                                                    <i class="fas fa-arrow-left me-2"></i>{% trans "تصفح" %} {{ cat_data.category.name }}
                                                </a>
                                            {% else %}
                                                <a href="#"
                                                   class="btn btn-custom btn-secondary-custom mt-3 disabled"
                                                   aria-disabled="true">
                                                    <i class="fas fa-arrow-left me-2"></i>{% trans "تصفح" %} {{ cat_data.category.name }}
                                                </a>
                                            {% endif %}
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
            <!-- Individual Section Tabs -->
            {% for section_code, section_data in categories_by_section.items %}
                <div class="tab-content" id="{{ section_code }}">
                    {% if section_data.categories %}
                        <div class="section-group">
                            <h3 class="section-subtitle">{{ section_data.name }}</h3>
                            <div class="row g-4">
                                {% for cat_data in section_data.categories %}
                                    <div class="col-lg-4 col-md-6">
                                        <div class="category-card">
                                            <div class="category-icon">
                                                {% if cat_data.category.icon %}
                                                    <i class="{{ cat_data.category.icon }}"></i>
                                                {% else %}
                                                    <i class="fas fa-folder"></i>
                                                {% endif %}
                                            </div>
                                            <h4 class="category-title">
                                                {% if LANGUAGE_CODE == 'ar' and cat_data.category.name_ar %}
                                                    {{ cat_data.category.name_ar }}
                                                {% else %}
                                                    {{ cat_data.category.name }}
                                                {% endif %}
                                            </h4>
                                            <p class="category-desc">{{ cat_data.category.description|truncatewords:15 }}</p>
                                            {% if cat_data.subcategories %}
                                                <div class="subcategories-list mb-3">
                                                    <h6 class="subcategories-title">{% trans "التصنيفات الفرعية:" %}</h6>
                                                    <ul class="subcategories">
                                                        {% for subcat in cat_data.subcategories %}
                                                            <li>
                                                                {% if subcat.slug %}
                                                                    <a href="{% url 'main:category_detail' subcat.slug %}"
                                                                       class="subcategory-link">
                                                                        {% if LANGUAGE_CODE == 'ar' and subcat.name_ar %}
                                                                            {{ subcat.name_ar }}
                                                                        {% else %}
                                                                            {{ subcat.name }}
                                                                        {% endif %}
                                                                    </a>
                                                                {% else %}
                                                                    <span class="subcategory-link disabled">
                                                                        {% if LANGUAGE_CODE == 'ar' and subcat.name_ar %}
                                                                            {{ subcat.name_ar }}
                                                                        {% else %}
                                                                            {{ subcat.name }}
                                                                        {% endif %}
                                                                    </span>
                                                                {% endif %}
                                                            </li>
                                                        {% endfor %}
                                                    </ul>
                                                </div>
                                            {% endif %}
                                            {% if cat_data.category.slug %}
                                                <a href="{% url 'main:category_detail' cat_data.category.slug %}"
                                                   class="btn btn-custom btn-primary-custom mt-3">
                                                    <i class="fas fa-arrow-left me-2"></i>{% trans "تصفح" %} {{ cat_data.category.name }}
                                                </a>
                                            {% else %}
                                                <a href="#"
                                                   class="btn btn-custom btn-secondary-custom mt-3 disabled"
                                                   aria-disabled="true">
                                                    <i class="fas fa-arrow-left me-2"></i>{% trans "تصفح" %} {{ cat_data.category.name }}
                                                </a>
                                            {% endif %}
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    {% endif %}
                </div>
            {% endfor %}
            <!-- Fallback static categories if no dynamic categories -->
            {% if not categories_by_section %}
                <div class="row g-4">
                    <div class="col-lg-4 col-md-6" data-category="classifieds">
                        <div class="category-card">
                            <div class="category-icon">
                                <i class="fas fa-bullhorn"></i>
                            </div>
                            <h3 class="category-title">{% trans "إعلانات مبوبة" %}</h3>
                            <p class="category-desc">{% trans "تصفح أو أضف إعلانك في منصة تجمع جميع الاحتياجات في مكان واحد" %}</p>
                            <a href="#" class="btn btn-custom btn-primary-custom mt-3">
                                <i class="fas fa-arrow-left me-2"></i>{% trans "تصفح الإعلانات" %}
                            </a>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6" data-category="marketplace">
                        <div class="category-card">
                            <div class="category-icon">
                                <i class="fas fa-shopping-basket"></i>
                            </div>
                            <h3 class="category-title">{% trans "متجر متعدد التجار" %}</h3>
                            <p class="category-desc">{% trans "منصة متكاملة لبيع المنتجات مع إدارة كاملة لحسابات التجار" %}</p>
                            <a href="#" class="btn btn-custom btn-primary-custom mt-3">
                                <i class="fas fa-arrow-left me-2"></i>{% trans "اكتشف المنتجات" %}
                            </a>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6" data-category="services">
                        <div class="category-card">
                            <div class="category-icon">
                                <i class="fas fa-concierge-bell"></i>
                            </div>
                            <h3 class="category-title">{% trans "طلب خدمة" %}</h3>
                            <p class="category-desc">{% trans "اطلب خدمة متخصصة بسهولة من الخبراء المعتمدين" %}</p>
                            <a href="#" class="btn btn-custom btn-primary-custom mt-3">
                                <i class="fas fa-arrow-left me-2"></i>{% trans "اطلب الآن" %}
                            </a>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6" data-category="training">
                        <div class="category-card">
                            <div class="category-icon">
                                <i class="fas fa-chalkboard-teacher"></i>
                            </div>
                            <h3 class="category-title">{% trans "الدورات التدريبية" %}</h3>
                            <p class="category-desc">{% trans "دورات معتمدة لرفع مهاراتك المهنية والعملية" %}</p>
                            <a href="#" class="btn btn-custom btn-primary-custom mt-3">
                                <i class="fas fa-arrow-left me-2"></i>{% trans "ابدأ التعلم" %}
                            </a>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6" data-category="jobs">
                        <div class="category-card">
                            <div class="category-icon">
                                <i class="fas fa-briefcase"></i>
                            </div>
                            <h3 class="category-title">{% trans "التوظيف" %}</h3>
                            <p class="category-desc">{% trans "فرص عمل متنوعة تجمع بين الكفاءات والشركات في مكان واحد" %}</p>
                            <a href="#" class="btn btn-custom btn-primary-custom mt-3">
                                <i class="fas fa-arrow-left me-2"></i>{% trans "ابحث عن وظيفة" %}
                            </a>
                        </div>
                    </div>
                </div>
            {% endif %}
        </div>
    </section>
    <!-- Swiper Section -->
    <section class="swiper-section" id="featured">
        <div class="container">
            <h2 class="section-title">{% trans "الإعلانات المميزة" %}</h2>
            <div class="swiper idrisiMartFeaturedSwiper">
                <div class="swiper-wrapper">
                    <div class="swiper-slide">
                        <img src="https://images.unsplash.com/photo-1556761175-b413da4baf72?w=400&h=300&fit=crop"
                             alt="Ad 3"
                             width="400"
                             height="300" />
                        <h4 class="mt-3 mb-2">{% trans "إعلان مميز 3" %}</h4>
                        <p class="text-muted">{% trans "وصف الإعلان المميز الثالث" %}</p>
                        <a href="#" class="btn btn-custom btn-secondary-custom btn-sm mt-2">{% trans "عرض التفاصيل" %}</a>
                    </div>
                    <div class="swiper-slide">
                        <img src="https://images.unsplash.com/photo-1522202176988-66273c2fd55f?w=400&h=300&fit=crop"
                             alt="Ad 4"
                             width="400"
                             height="300" />
                        <h4 class="mt-3 mb-2">{% trans "إعلان مميز 4" %}</h4>
                        <p class="text-muted">{% trans "وصف الإعلان المميز الرابع" %}</p>
                        <a href="#" class="btn btn-custom btn-secondary-custom btn-sm mt-2">{% trans "عرض التفاصيل" %}</a>
                    </div>
                    <div class="swiper-slide">
                        <img src="https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=400&h=300&fit=crop"
                             alt="Ad 1"
                             width="400"
                             height="300" />
                        <h4 class="mt-3 mb-2">{% trans "إعلان مميز 1" %}</h4>
                        <p class="text-muted">{% trans "وصف الإعلان المميز الأول" %}</p>
                        <a href="#" class="btn btn-custom btn-secondary-custom btn-sm mt-2">{% trans "عرض التفاصيل" %}</a>
                    </div>
                    <div class="swiper-slide">
                        <img src="https://images.unsplash.com/photo-1552664730-d307ca884978?w=400&h=300&fit=crop"
                             alt="Ad 2"
                             width="400"
                             height="300" />
                        <h4 class="mt-3 mb-2">{% trans "إعلان مميز 2" %}</h4>
                        <p class="text-muted">{% trans "وصف الإعلان المميز الثاني" %}</p>
                        <a href="#" class="btn btn-custom btn-secondary-custom btn-sm mt-2">{% trans "عرض التفاصيل" %}</a>
                    </div>
                    <div class="swiper-slide">
                        <img src="https://images.unsplash.com/photo-1556761175-b413da4baf72?w=400&h=300&fit=crop"
                             alt="Ad 3"
                             width="400"
                             height="300" />
                        <h4 class="mt-3 mb-2">{% trans "إعلان مميز 3" %}</h4>
                        <p class="text-muted">{% trans "وصف الإعلان المميز الثالث" %}</p>
                        <a href="#" class="btn btn-custom btn-secondary-custom btn-sm mt-2">{% trans "عرض التفاصيل" %}</a>
                    </div>
                    <div class="swiper-slide">
                        <img src="https://images.unsplash.com/photo-1522202176988-66273c2fd55f?w=400&h=300&fit=crop"
                             alt="Ad 4"
                             width="400"
                             height="300" />
                        <h4 class="mt-3 mb-2">{% trans "إعلان مميز 4" %}</h4>
                        <p class="text-muted">{% trans "وصف الإعلان المميز الرابع" %}</p>
                        <a href="#" class="btn btn-custom btn-secondary-custom btn-sm mt-2">{% trans "عرض التفاصيل" %}</a>
                    </div>
                </div>
                <div class="swiper-pagination"></div>
            </div>
        </div>
    </section>
    <!-- Features Section -->
    <section class="features-section" id="about">
        <div class="container">
            <h2 class="section-title text-white">{% trans "لماذا إدريسي مارت للمساحة؟" %}</h2>
            <div class="row g-4">
                <div class="col-lg-3 col-md-6">
                    <div class="feature-box">
                        <div class="feature-icon">
                            <i class="fas fa-crosshairs"></i>
                        </div>
                        <h4 class="feature-title">{% trans "دقة عالية" %}</h4>
                        <p>{% trans "نضمن أعلى معايير الدقة في جميع أعمال المساحة والقياس" %}</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="feature-box">
                        <div class="feature-icon">
                            <i class="fas fa-satellite"></i>
                        </div>
                        <h4 class="feature-title">{% trans "تقنية متطورة" %}</h4>
                        <p>{% trans "نستخدم أحدث أجهزة المساحة والتقنيات الجيوديسية" %}</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="feature-box">
                        <div class="feature-icon">
                            <i class="fas fa-certificate"></i>
                        </div>
                        <h4 class="feature-title">{% trans "خبرة معتمدة" %}</h4>
                        <p>{% trans "فريق من المهندسين المساحين المعتمدين وذوي الخبرة" %}</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="feature-box">
                        <div class="feature-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <h4 class="feature-title">{% trans "تسليم سريع" %}</h4>
                        <p>{% trans "التزام بالمواعيد المحددة وتسليم المشاريع في الوقت" %}</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Stats Section -->
    <section class="stats-section py-5 bg-secondary-light">
        <div class="container">
            <div class="row text-center g-4">
                <div class="col-lg-3 col-md-6">
                    <div class="stat-box">
                        <i class="fas fa-map fa-3x mb-3 text-primary-color"></i>
                        <h3 class="stat-number" data-target="250">0</h3>
                        <p class="stat-label">{% trans "مشروع مساحي منجز" %}</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="stat-box">
                        <i class="fas fa-drafting-compass fa-3x mb-3 text-secondary-color"></i>
                        <h3 class="stat-number" data-target="500">0</h3>
                        <p class="stat-label">{% trans "خريطة مساحية" %}</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="stat-box">
                        <i class="fas fa-users fa-3x mb-3 text-primary-color"></i>
                        <h3 class="stat-number" data-target="150">0</h3>
                        <p class="stat-label">{% trans "عميل راضٍ" %}</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="stat-box">
                        <i class="fas fa-award fa-3x mb-3 text-secondary-color"></i>
                        <h3 class="stat-number" data-target="15">0</h3>
                        <p class="stat-label">{% trans "سنة خبرة" %}</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

{% endblock content %}

{% block extra_js %}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Tab functionality for category sections
            const tabButtons = document.querySelectorAll('.tab-btn')
            const tabContents = document.querySelectorAll('.tab-content')

            tabButtons.forEach((button) => {
                button.addEventListener('click', function() {
                    const targetTab = this.getAttribute('data-tab')

                    // Remove active class from all buttons and contents
                    tabButtons.forEach((btn) => btn.classList.remove('active'))
                    tabContents.forEach((content) => content.classList.remove('active'))

                    // Add active class to clicked button and corresponding content
                    this.classList.add('active')
                    const targetContent = document.getElementById(targetTab)
                    if (targetContent) {
                        targetContent.classList.add('active')
                    }
                })
            })

            // Swiper initialization
            const idrisiMartSwiper = new Swiper('.idrisiMartFeaturedSwiper', {
                slidesPerView: 1,
                spaceBetween: 20,
                loop: true,
                autoplay: {
                    delay: 3000,
                    disableOnInteraction: false,
                    pauseOnMouseEnter: true,
                },
                pagination: {
                    el: '.swiper-pagination',
                    clickable: true,
                    dynamicBullets: true,
                },
                navigation: {
                    nextEl: '.swiper-button-next',
                    prevEl: '.swiper-button-prev',
                },
                breakpoints: {
                    576: {
                        slidesPerView: 2,
                        spaceBetween: 20,
                    },
                    768: {
                        slidesPerView: 3,
                        spaceBetween: 25,
                    },
                    992: {
                        slidesPerView: 3,
                        spaceBetween: 30,
                    },
                    1200: {
                        slidesPerView: 3,
                        spaceBetween: 35,
                    },
                    1400: {
                        slidesPerView: 4,
                        spaceBetween: 40,
                    },
                },
                speed: 600,
                effect: 'slide',
                grabCursor: true,
                watchSlidesProgress: true,
                lazy: {
                    loadPrevNext: true,
                    loadOnTransitionStart: true,
                },
                on: {
                    init: function() {
                        console.log('🎨 Idrisi Mart Swiper Initialized')
                    },
                },
            })
        })
    </script>

{% endblock extra_js %}
