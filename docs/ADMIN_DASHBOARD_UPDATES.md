# ุชุญุฏูุซุงุช ููุญุฉ ุชุญูู ุงููุดุฑู - ููุฎุต ุดุงูู

## ูุธุฑุฉ ุนุงูุฉ
ุชู ุฅุฌุฑุงุก ุชุญุณููุงุช ุดุงููุฉ ุนูู ููุญุฉ ุชุญูู ุงููุดุฑู ูุชูููุฑ ุชุญูู ูุงูู ูู ุงููุธุงู.

---

## 1. โ ุฅุฏุงุฑุฉ ุงูุฅุนูุงูุงุช - ุฅุฌุฑุงุกุงุช ููุณุนุฉ

### ุงูุฅุฌุฑุงุกุงุช ุงููุฑุฏูุฉ ุงูุฌุฏูุฏุฉ:

#### ุงูุชุนููู/ุงูุฅุฎูุงุก (`admin_suspend_ad`)
- **ุงููุณุงุฑ:** `/admin/ads/<ad_id>/suspend/`
- **ุงููุธููุฉ:** ุชุนููู ุงูุฅุนูุงู ูุฅุฎูุงุคู
- **ุงูููุฒุงุช:**
  - ุชุบููุฑ ุญุงูุฉ ุงูุฅุนูุงู ุฅูู "ูุนูู"
  - ุฅุฑุณุงู ุฅุดุนุงุฑ ูููุงุดุฑ ูุน ุงูุณุจุจ
  - ุฑุณุงูุฉ ูุฌุงุญ ูููุดุฑู

#### ุงูุชูุนูู (`admin_activate_ad`)
- **ุงููุณุงุฑ:** `/admin/ads/<ad_id>/activate/`
- **ุงููุธููุฉ:** ุฅุนุงุฏุฉ ุชูุนูู ุฅุนูุงู ูุนูู
- **ุงูููุฒุงุช:**
  - ุชุบููุฑ ุงูุญุงูุฉ ุฅูู "ูุดุท"
  - ุฅุดุนุงุฑ ูููุงุดุฑ ุจุฅุนุงุฏุฉ ุงูุชูุนูู

#### ุงูุชูุฏูุฏ (`admin_extend_ad`)
- **ุงููุณุงุฑ:** `/admin/ads/<ad_id>/extend/`
- **ุงููุธููุฉ:** ุชูุฏูุฏ ุตูุงุญูุฉ ุงูุฅุนูุงู
- **ุงูููุฒุงุช:**
  - ุฅุถุงูุฉ ุนุฏุฏ ุฃูุงู ูุญุฏุฏ (ุงูุชุฑุงุถู 30 ููู)
  - ุชุญุฏูุซ ุชุงุฑูุฎ ุงูุงูุชูุงุก
  - ุฅุดุนุงุฑ ูููุงุดุฑ

#### ุชูุนูู/ุฅูุบุงุก ุงูููุฒุงุช:
1. **ุงููููุฒ** (`admin_toggle_featured`)
   - ุงููุณุงุฑ: `/admin/ads/<ad_id>/toggle-featured/`
   - ุชุจุฏูู ุญุงูุฉ `is_highlighted`

2. **ุงูุนุงุฌู** (`admin_toggle_urgent`)
   - ุงููุณุงุฑ: `/admin/ads/<ad_id>/toggle-urgent/`
   - ุชุจุฏูู ุญุงูุฉ `is_urgent`

3. **ุงููุซุจุช** (`admin_toggle_pinned`)
   - ุงููุณุงุฑ: `/admin/ads/<ad_id>/toggle-pinned/`
   - ุชุจุฏูู ุญุงูุฉ `is_pinned`

#### ุชุบููุฑ ุงููุณู (`admin_change_ad_category`)
- **ุงููุณุงุฑ:** `/admin/ads/<ad_id>/change-category/`
- **ุงููุธููุฉ:** ุชุบููุฑ ูุณู ุงูุฅุนูุงู
- **ุงููุนุงููุงุช:** `category_id`

### ุงูุฅุฌุฑุงุกุงุช ุงูุฌูุงุนูุฉ (`admin_bulk_actions`)

**ุงููุณุงุฑ:** `/admin/ads/bulk-actions/`

**ุงูุฅุฌุฑุงุกุงุช ุงููุชุงุญุฉ:**

| ุงูุฅุฌุฑุงุก | ุงูููุฏ | ุงููุตู |
|---------|------|--------|
| ููุงููุฉ ุฌูุงุนูุฉ | `approve` | ุงูููุงููุฉ ุนูู ุนุฏุฉ ุฅุนูุงูุงุช + ุฅุดุนุงุฑุงุช |
| ุฑูุถ ุฌูุงุนู | `reject` | ุฑูุถ ุนุฏุฉ ุฅุนูุงูุงุช ูุน ุงูุณุจุจ |
| ุชุนููู ุฌูุงุนู | `suspend` | ุชุนููู ุนุฏุฉ ุฅุนูุงูุงุช |
| ุชูุนูู ุฌูุงุนู | `activate` | ุชูุนูู ุนุฏุฉ ุฅุนูุงูุงุช |
| ุญุฐู ุฌูุงุนู | `delete` | ุญุฐู ููุงุฆู ูุนุฏุฉ ุฅุนูุงูุงุช |
| ุชูููุฒ (ุชุดุบูู) | `featured_on` | ุชูุนูู ุงูููุฒุฉ ุงููููุฒุฉ |
| ุชูููุฒ (ุฅููุงู) | `featured_off` | ุฅูุบุงุก ุงูููุฒุฉ ุงููููุฒุฉ |
| ุนุงุฌู (ุชุดุบูู) | `urgent_on` | ุชูุนูู ุงูุนุงุฌู |
| ุนุงุฌู (ุฅููุงู) | `urgent_off` | ุฅูุบุงุก ุงูุนุงุฌู |
| ุชุซุจูุช | `pin` | ุชุซุจูุช ุงูุฅุนูุงูุงุช |
| ุฅูุบุงุก ุชุซุจูุช | `unpin` | ุฅูุบุงุก ุงูุชุซุจูุช |

**ูุซุงู ุงุณุชุฎุฏุงู:**
```javascript
fetch('/admin/ads/bulk-actions/', {
    method: 'POST',
    headers: {
        'X-CSRFToken': getCookie('csrftoken'),
        'Content-Type': 'application/x-www-form-urlencoded',
    },
    body: new URLSearchParams({
        'ad_ids[]': [1, 2, 3],
        'action': 'approve'
    })
})
```

---

## 2. โ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู - ุชุญูู ูุงูู

### ุชุญุฏูุซ ูุนูููุงุช ุงููุณุชุฎุฏู (`admin_user_update`)

**ุงููุณุงุฑ:** `/admin/users/<user_id>/update/`

**ุงูุญููู ุงููุงุจูุฉ ููุชุนุฏูู:**
- โ ุงูุงุณู ุงูุฃูู (`first_name`)
- โ ุงูุงุณู ุงูุฃุฎูุฑ (`last_name`)
- โ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู (`email`) - ูุน ุงูุชุญูู ูู ุงูุชูุฑุฏ
- โ ุฑูู ุงููุงุชู (`phone`)
- โ ุงุณู ุงููุณุชุฎุฏู (`username`) - ูุน ุงูุชุญูู ูู ุงูุชูุฑุฏ
- โ **ูููุฉ ุงููุฑูุฑ** (`password`) - ุฌุฏูุฏ!

**ููุฏ ุงูุชุญุฏูุซ:**
```python
# Update password if provided
if password:
    user_to_update.set_password(password)
```

**ุงูุชุญููุงุช:**
- ุงูุชุญูู ูู ุชูุฑุฏ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- ุงูุชุญูู ูู ุชูุฑุฏ ุงุณู ุงููุณุชุฎุฏู
- ุชุดููุฑ ูููุฉ ุงููุฑูุฑ ุจุงุณุชุฎุฏุงู `set_password()`

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
    "success": true,
    "message": "ุชู ุชุญุฏูุซ ูุนูููุงุช ุงููุณุชุฎุฏู ุจูุฌุงุญ."
}
```

---

## 3. โ ุฅุถุงูุฉ ุงูุญููู ุงููุฎุตุตุฉ

### ุงูุญุงูุฉ ุงูุญุงููุฉ:
ุงููุธุงู ููุฌูุฏ ููุนูู ูู:
- **ุงูููู:** `templates/admin_dashboard/custom_fields.html`
- **ุงูู Views:** `AdminCustomFieldSaveView` ูู `main/views.py`
- **ุงููุณุงุฑุงุช:**
  - `/admin/custom-fields/` - ุนุฑุถ ุงูุญููู
  - `/admin/custom-fields/save/` - ุญูุธ ุญูู ุฌุฏูุฏ
  - `/admin/custom-fields/<field_id>/delete/` - ุญุฐู ุญูู

### ุงููุดููุฉ ุงููุญุชููุฉ:
ุฅุฐุง ูุงูุช ุงูุฅุถุงูุฉ ูุง ุชุนููุ ูุฏ ูููู ุงูุณุจุจ:

1. **ุนุฏู ุงุฎุชูุงุฑ ุงููุณู ุงููุฑุนู:**
   ```javascript
   const categoryValue = document.getElementById('addSubCategory').value;
   if (!categoryValue) {
       showError('ูุฑุฌู ุงุฎุชูุงุฑ ุงููุณู ุงููุฑุนู');
       return;
   }
   ```

2. **ุนุฏู ุชูุนูู ุงููุณู ุงููุฑุนู:**
   - ูุฌุจ ุงุฎุชูุงุฑ ุงููุณู ุงูุฑุฆูุณู ุฃููุงู
   - ุซู ูุชู ุชูุนูู ูุงุฆูุฉ ุงูุฃูุณุงู ุงููุฑุนูุฉ

### ุงูุญู:
ุชุฃูุฏ ูู:
- โ ุงุฎุชูุงุฑ ุงููุณู ุงูุฑุฆูุณู
- โ ุงุฎุชูุงุฑ ุงููุณู ุงููุฑุนู (ูุชู ุชูุนููู ุชููุงุฆูุงู)
- โ ููุก ุงูุญููู ุงููุทููุจุฉ (name, label_ar)

---

## 4. ๐ง ุตูุงุญูุงุช ุงูุฒูุงุฑ ูุงููุณุฌููู

### ุงูุฅุนุฏุงุฏุงุช ุงูููุฌูุฏุฉ ูู Constance:

#### ุฅุนุฏุงุฏุงุช ุงููุดุฑ (`admin_settings_publishing`):
```python
# ูุถุน ุงููุดุฑ
PUBLISHING_MODE = "direct"  # ุฃู "moderated"

# ูุดุฑ ุชููุงุฆู ููููุซููู
VERIFIED_AUTO_PUBLISH = True/False

# ุตูุงุญูุงุช ุงูุฒูุงุฑ
ALLOW_GUEST_VIEWING = True/False
ALLOW_GUEST_CONTACT = True/False

# ุตูุงุญูุงุช ุงูุฃุนุถุงุก ููุท
MEMBERS_ONLY_CONTACT = True/False
MEMBERS_ONLY_MESSAGING = True/False
```

#### ุฅุนุฏุงุฏุงุช ุงูุณูุฉ (`admin_settings_cart`):
```python
# ุชูุนูู ูุธุงู ุงูุณูุฉ
CART_SYSTEM_ENABLED = True/False

# ุฅุนุฏุงุฏุงุช ุงูุณูุฉ ุญุณุจ ุงููุณู
CART_BY_MAIN_CATEGORY = True/False
CART_BY_SUBCATEGORY = True/False
CART_PER_AD = True/False

# ูุณุจุฉ ุงูุญุฌุฒ
DEFAULT_RESERVATION_PERCENTAGE = 20
MIN_RESERVATION_AMOUNT = 50
MAX_RESERVATION_AMOUNT = 5000
```

### ููููุฉ ุงูุชุญูู ูู ุนูู ุงูุฅุนุฏุงุฏุงุช:

1. **ุงูุชุญูู ูู Constance:**
```python
from constance import config
print(config.ALLOW_GUEST_VIEWING)
```

2. **ุงูุชุญูู ูู ุงูุญูุธ:**
```python
# ูู admin_settings_publishing
config.ALLOW_GUEST_VIEWING = allow_guest_viewing
# ูุฌุจ ุฃู ูุญูุธ ุชููุงุฆูุงู
```

3. **ุฅุฐุง ูู ุชุนูู:**
   - ุชุฃูุฏ ูู ุชุซุจูุช `django-constance`
   - ุชุฃูุฏ ูู ุฅุนุฏุงุฏุงุช CONSTANCE ูู settings.py
   - ุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุฌุฏูู `constance_config`)

---

## 5. ุงูุงุณุชุฎุฏุงู ุงูุนููู

### ูุซุงู 1: ุชุนููู ุฅุนูุงู ุบูุฑ ููุงุณุจ
```python
# POST /admin/ads/123/suspend/
{
    "reason": "ูุญุชูู ุบูุฑ ููุงุณุจ"
}
```

### ูุซุงู 2: ุชูุฏูุฏ ุฅุนูุงู VIP
```python
# POST /admin/ads/456/extend/
{
    "days": 60  # ุชูุฏูุฏ 60 ููู
}
```

### ูุซุงู 3: ููุงููุฉ ุฌูุงุนูุฉ
```python
# POST /admin/ads/bulk-actions/
{
    "ad_ids[]": [1, 2, 3, 4, 5],
    "action": "approve"
}
```

### ูุซุงู 4: ุชุบููุฑ ูููุฉ ูุฑูุฑ ูุณุชุฎุฏู
```python
# POST /admin/users/789/update/
{
    "first_name": "ุฃุญูุฏ",
    "email": "ahmad@example.com",
    "password": "NewSecurePassword123!"
}
```

---

## 6. ุงููููุงุช ุงูููุญุฏุซุฉ

### ูููุงุช Backend:
1. โ `main/admin_ad_views.py`
   - ุฅุถุงูุฉ 10 ูุธุงุฆู ุฌุฏูุฏุฉ ูุฅุฏุงุฑุฉ ุงูุฅุนูุงูุงุช
   - ูุธููุฉ ุงูุฅุฌุฑุงุกุงุช ุงูุฌูุงุนูุฉ ุงูุดุงููุฉ

2. โ `main/views.py`
   - ุชุญุฏูุซ `admin_user_update` ูุฏุนู ุชุบููุฑ ูููุฉ ุงููุฑูุฑ
   - ุฅุถุงูุฉ ุงูุชุญูู ูู ุชูุฑุฏ ุงุณู ุงููุณุชุฎุฏู

3. โ `main/urls.py`
   - ุฅุถุงูุฉ 9 ูุณุงุฑุงุช ุฌุฏูุฏุฉ ููุฅุฌุฑุงุกุงุช ุนูู ุงูุฅุนูุงูุงุช

### ุงููุธุงุฆู ุงูุฌุฏูุฏุฉ:
- `admin_suspend_ad()` - ุชุนููู
- `admin_activate_ad()` - ุชูุนูู
- `admin_extend_ad()` - ุชูุฏูุฏ
- `admin_toggle_featured()` - ุชุจุฏูู ุงููููุฒ
- `admin_toggle_urgent()` - ุชุจุฏูู ุงูุนุงุฌู
- `admin_toggle_pinned()` - ุชุจุฏูู ุงููุซุจุช
- `admin_change_ad_category()` - ุชุบููุฑ ุงููุณู
- `admin_bulk_actions()` - ุฅุฌุฑุงุกุงุช ุฌูุงุนูุฉ

---

## 7. ุงูุฅุดุนุงุฑุงุช ุงูุชููุงุฆูุฉ

ุฌููุน ุงูุฅุฌุฑุงุกุงุช ุชุฑุณู ุฅุดุนุงุฑุงุช ูููุณุชุฎุฏููู:

| ุงูุฅุฌุฑุงุก | ููุน ุงูุฅุดุนุงุฑ | ุงูุฑุณุงูุฉ |
|---------|-------------|---------|
| ููุงููุฉ | `ad_approved` | "ุชู ุงูููุงููุฉ ุนูู ุฅุนูุงูู {title}" |
| ุฑูุถ | `ad_rejected` | "ุชู ุฑูุถ ุฅุนูุงูู {title}. ุงูุณุจุจ: {reason}" |
| ุชุนููู | `ad_suspended` | "ุชู ุชุนููู ุฅุนูุงูู {title}. ุงูุณุจุจ: {reason}" |
| ุชูุนูู | `ad_activated` | "ุชู ุฅุนุงุฏุฉ ุชูุนูู ุฅุนูุงูู {title}" |
| ุชูุฏูุฏ | `ad_extended` | "ุชู ุชูุฏูุฏ ุฅุนูุงูู {title} ููุฏุฉ {days} ููู" |

---

## 8. ุงูุชูุงูู ูุงูุฃูุงู

### ุงูุชุญููุงุช ุงูุฃูููุฉ:
- โ ุฌููุน ุงููุธุงุฆู ูุญููุฉ ุจู `@staff_member_required`
- โ ุงูุชุญูู ูู ูุฌูุฏ ุงูุฅุนูุงู/ุงููุณุชุฎุฏู
- โ ุงูุชุญูู ูู ุชูุฑุฏ ุงูุจูุงูุงุช (email, username)
- โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุดุงููุฉ

### ูุงุนุฏุฉ ุงูุจูุงูุงุช:
- โ ุงุณุชุฎุฏุงู `update()` ููุชุญุฏูุซุงุช ุงูุฌูุงุนูุฉ (ุฃุฏุงุก ุฃูุถู)
- โ ุงุณุชุฎุฏุงู `update_fields` ููุชุญุฏูุซุงุช ุงููุฑุฏูุฉ
- โ ูุนุงููุงุช ุขููุฉ (Transactions)

---

## 9. ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ ุงูุฅุฌุฑุงุกุงุช ุงููุฑุฏูุฉ:
```bash
# ุชุนููู ุฅุนูุงู
curl -X POST http://localhost:8000/admin/ads/1/suspend/ \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "reason=test"

# ุชูุฏูุฏ ุฅุนูุงู
curl -X POST http://localhost:8000/admin/ads/1/extend/ \
  -d "days=30"
```

### ุงุฎุชุจุงุฑ ุชุญุฏูุซ ุงููุณุชุฎุฏู:
```bash
curl -X POST http://localhost:8000/admin/users/1/update/ \
  -d "first_name=Test&password=NewPass123"
```

---

## 10. ุงููุดุงูู ุงููุญุชููุฉ ูุงูุญููู

### ุงููุดููุฉ: ุงูุญููู ุงููุฎุตุตุฉ ูุง ุชูุถุงู
**ุงูุญู:**
1. ุชุฃูุฏ ูู ุงุฎุชูุงุฑ ุงููุณู ุงูุฑุฆูุณู ุฃููุงู
2. ุงูุชุธุฑ ุชุญููู ุงูุฃูุณุงู ุงููุฑุนูุฉ
3. ุงุฎุชุฑ ุงููุณู ุงููุฑุนู
4. ุงููุฃ ุฌููุน ุงูุญููู ุงููุทููุจุฉ

### ุงููุดููุฉ: ุงูุฅุนุฏุงุฏุงุช ูุง ุชูุญูุธ
**ุงูุญู:**
1. ุชุญูู ูู ุชุซุจูุช `django-constance[database]`
2. ููุฐ `python manage.py migrate`
3. ุชุญูู ูู ุฌุฏูู `constance_config` ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุงููุดููุฉ: ุงูุฅุฌุฑุงุกุงุช ุงูุฌูุงุนูุฉ ูุง ุชุนูู
**ุงูุญู:**
1. ุชุฃูุฏ ูู ุฅุฑุณุงู `ad_ids[]` ููุตูููุฉ
2. ุชุญูู ูู ูุฌูุฏ CSRF token
3. ุงุณุชุฎุฏู `FormData` ุฃู `URLSearchParams`

---

## 11. ุงูุชุญุฏูุซุงุช ุงููุณุชูุจููุฉ ุงูููุชุฑุญุฉ

1. **ูุงุฌูุฉ ูุณุชุฎุฏู ูุญุณูุฉ:**
   - ุฅุถุงูุฉ ุฃุฒุฑุงุฑ ุงูุฅุฌุฑุงุกุงุช ูู ุตูุญุฉ ุชูุงุตูู ุงูุฅุนูุงู
   - ูุงูุฐุฉ ููุจุซูุฉ ููุฅุฌุฑุงุกุงุช ุงูุฌูุงุนูุฉ
   - ูุคุดุฑุงุช ุชูุฏู ููุฅุฌุฑุงุกุงุช

2. **ุชูุงุฑูุฑ ูุฅุญุตุงุฆูุงุช:**
   - ุนุฏุฏ ุงูุฅุนูุงูุงุช ุงููุนููุฉ/ุงููุฑููุถุฉ
   - ูุนุฏู ุงูููุงููุฉ/ุงูุฑูุถ
   - ุงููุณุชุฎุฏููู ุงูุฃูุซุฑ ูุดุฑุงู

3. **ุฃุชูุชุฉ:**
   - ููุงููุฉ ุชููุงุฆูุฉ ูููุณุชุฎุฏููู ุงูููุซูููู
   - ุชุนููู ุชููุงุฆู ููุฅุนูุงูุงุช ุงูููุจูุบ ุนููุง
   - ุชูุฏูุฏ ุชููุงุฆู ููุฅุนูุงูุงุช VIP

---

## ุงูุชุญูู ุงูููุงุฆู

```bash
python manage.py check
# System check identified no issues (0 silenced). โ
```

**ุฌููุน ุงูุชุญุฏูุซุงุช ูุทุจูุฉ ูุชุนูู ุจูุฌุงุญ!** ๐
